<%- partial('_partial/nav-rail') %>
<main>
  <h1><%= page.archive ? page.title : 'Archives' %></h1>

  <% 
    const years = {};
    page.posts.each(post => {
      const year = post.date.year();
      if (!years[year]) {
        years[year] = [];
      }
      years[year].push(post);
    });
    const sortedYears = Object.keys(years).sort((a, b) => b - a);
  %>

  <nav class="year-nav">
    <% sortedYears.forEach(year => { %>
      <a href="#year-<%= year %>"><%= year %></a>
    <% }); %>
  </nav>

  <% sortedYears.forEach(year => { %>
    <section id="year-<%= year %>" class="archive-year">
      <h2><%= year %></h2>
      <div class="post-grid">
        <% years[year].forEach(post => { %>
          <md-elevated-card class="post-card">
            <h2><a href="<%- url_for(post.path) %>"><%= post.title %></a></h2>
            <time datetime="<%= date_xml(post.date) %>"><%= date(post.date, 'YYYY-MM-DD') %></time>
            <p><%= post.excerpt %></p>
          </md-elevated-card>
        <% }); %>
      </div>
    </section>
  <% }); %>

  <% if (page.total > 1){ %>
    <nav class="pagination">
      <%- paginator() %>
    </nav>
  <% } %>
</main>
<%- partial('_partial/footer') %>
